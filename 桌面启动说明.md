# 持仓整理工具 - 桌面 exe 启动说明

通过本说明可生成一个**桌面快捷方式**，双击后自动启动服务并打开网页，无需每次手动运行 `node server.js`。

---

## 一、前提条件

- 本机已安装 **Node.js**（建议 18+），且已加入系统 PATH（安装时勾选 “Add to PATH” 即可）。
- 项目目录内已执行过 `npm install`，存在 `node_modules`。

---

## 二、生成 exe 启动文件

在项目目录（与 `server.js`、`持仓整理工具.html` 同级）打开终端，执行：

```bash
npm install
npm run build:exe
```

执行成功后，当前目录下会生成 **`portfolio-manager.exe`**。

---

## 三、放到桌面并双击使用

### 方式 A：直接放桌面（需一起拷贝整个项目）

1. 将**整个项目文件夹**（包含 `portfolio-manager.exe`、`server.js`、`持仓整理工具.html`、`node_modules` 等）复制到任意位置（例如 `D:\PortfolioManager`）。
2. 把 **`portfolio-manager.exe`** 的**快捷方式**放到桌面：
   - 右键 `portfolio-manager.exe` → **发送到** → **桌面快捷方式**。
3. 以后**双击该快捷方式**即可：
   - 自动在后台启动服务（端口 3011）；
   - 等待几秒后自动用默认浏览器打开 `http://localhost:3011`。

### 方式 B：只把快捷方式放桌面（项目保留在原位）

1. 保持项目在现有目录（如 `C:\Users\你的用户名\ZCodeProject\portfolio-manager`）。
2. 右键 **`portfolio-manager.exe`** → **发送到** → **桌面快捷方式**。
3. 双击桌面快捷方式即可启动并打开网页。

**注意**：exe 必须与 `server.js`、`持仓整理工具.html`、`node_modules` 在同一目录下，否则会启动失败。

---

## 四、exe 做了什么

1. 在 exe 所在目录启动 **`node server.js`**（端口 3011）。
2. 轮询 `http://localhost:3011/health`，直到服务就绪。
3. 用系统默认浏览器打开 **http://localhost:3011**。
4. 启动器进程退出，**服务在后台继续运行**。关闭浏览器不会关掉服务；要停止服务需在任务管理器中结束 `node.exe`，或关闭所有“持仓整理工具”相关窗口后下次不再双击 exe 即可。

---

## 五、若未安装 Node.js

1. 打开 [https://nodejs.org](https://nodejs.org)，下载并安装 LTS 版本。
2. 安装时勾选 **“Add to PATH”**。
3. 安装完成后重新打开终端，再执行上面的 `npm install` 与 `npm run build:exe`。

---

## 六、不打包 exe 的用法（仅用脚本）

若暂时不生成 exe，也可以直接运行启动脚本（需先 `cd` 到项目目录）：

```bash
node launcher.js
```

效果相同：启动服务并打开浏览器。可将 `node launcher.js` 做成一个 `.bat` 或快捷方式放在桌面使用。
