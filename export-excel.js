/**
 * 根据截图数据生成 Excel 持仓表
 */
const XLSX = require('xlsx');
const path = require('path');

const headers = ['资金账号', '产品名称', '市值', '名称', '代码', '可用持仓', '持仓量', '最新价', '昨日持仓', '在途数量', '冻结数量', '当日涨幅', '盈亏', '成本价', '盈亏比例'];

const data = [
  ['16254031', '汇宽天翼1号', 10425138.81, '中芯国际', '00981', 168500, 168500, 70.10, 168500, 0, 0, '0.43%', -1155360.69, 68.727, '-9.98%'],
  ['1161009037', '汇宽天翼1号', 931327.56, '中微公司', '688012', 2679, 2679, 347.64, 2679, 0, 0, '0.77%', -80971.78, 377.86, '-8.00%'],
  ['16254031', '汇宽天翼1号', 1663457.40, '中微公司', '688012', 4785, 4785, 347.64, 4785, 0, 0, '0.77%', -144501.74, 377.84, '-7.99%'],
  ['1161009037', '汇宽天翼1号', 2466372.00, '中际旭创', '300308', 4700, 4700, 524.76, 7500, 0, 0, '-0.51%', -647200.72, 662.46, '-20.79%'],
  ['16254031', '汇宽天翼1号', 3988176.00, '中际旭创', '300308', 7600, 7600, 524.76, 12300, 0, 0, '-0.51%', -968888.28, 652.25, '-19.55%'],
  ['1161009037', '汇宽天翼1号', 873600.00, '新易盛', '300502', 2400, 2400, 364.00, 4800, 0, 0, '-0.48%', -244333.06, 465.81, '-21.86%'],
  ['16254031', '汇宽天翼1号', 1274000.00, '新易盛', '300502', 3500, 3500, 364.00, 7400, 0, 0, '-0.48%', -397480.30, 477.57, '-23.78%'],
  ['1161009037', '汇宽天翼1号', 0.00, '先导智能', '300450', 0, 0, 55.31, 42400, 0, 0, '0.20%', -105654.37, 0.00, '0.00%'],
  ['16254031', '汇宽天翼1号', 0.00, '先导智能', '300450', 0, 0, 55.31, 21300, 0, 0, '0.20%', 5166.34, 0.00, '0.00%'],
  ['1161009037', '汇宽天翼1号', 17658030.00, '万里石', '002785', 370500, 370500, 47.66, 370500, 0, 0, '0.23%', 2647329.95, 40.51, '17.64%'],
  ['16254031', '汇宽天翼1号', 23415358.00, '万里石', '002785', 491300, 491300, 47.66, 491300, 0, 0, '0.23%', 3510928.06, 40.51, '17.64%'],
  ['1161009037', '汇宽天翼1号', 2579786.00, '盛屯矿业', '600711', 157400, 157400, 16.39, 157400, 0, 0, '-3.47%', -137139.47, 17.26, '-5.05%'],
  ['16254031', '汇宽天翼1号', 5621770.00, '盛屯矿业', '600711', 343000, 343000, 16.39, 343000, 0, 0, '-3.47%', -444630.90, 17.69, '-7.33%'],
  ['1161009037', '汇宽天翼1号', 2298120.00, '胜宏科技', '300476', 8800, 8800, 261.15, 8800, 0, 0, '0.29%', -58763.85, 267.83, '-2.49%'],
  ['16254031', '汇宽天翼1号', 3629985.00, '胜宏科技', '300476', 13900, 13900, 261.15, 13900, 0, 0, '0.29%', -92471.14, 267.80, '-2.48%'],
  ['1161009037', '汇宽天翼1号', 2180250.00, '润泽科技', '300442', 28500, 28500, 76.50, 28500, 0, 0, '0.00%', -180546.08, 82.83, '-7.65%'],
  ['16254031', '汇宽天翼1号', 4850100.00, '润泽科技', '300442', 63400, 63400, 76.50, 63400, 0, 0, '0.00%', -388882.92, 82.63, '-7.42%'],
  ['1161009037', '汇宽天翼1号', 2659163.00, '华联控股', '000036', 475700, 475700, 5.59, 475700, 0, 0, '-0.89%', -37708.74, 5.67, '-1.40%'],
  ['16254031', '汇宽天翼1号', 2693262.00, '华联控股', '000036', 481800, 481800, 5.59, 481800, 0, 0, '-0.89%', -65572.98, 5.73, '-2.38%'],
  ['1161009037', '汇宽天翼1号', 4341950.00, '半导体设备ETF', '159516', 2347000, 2347000, 1.850, 2347000, 0, 0, '1.98%', -241107.31, 1.953, '-5.26%'],
  ['16254031', '汇宽天翼1号', 5695040.00, '半导体设备ETF', '159516', 3078400, 3078400, 1.850, 3078400, 0, 0, '1.98%', -290293.12, 1.944, '-4.85%'],
];

const ws = XLSX.utils.aoa_to_sheet([headers, ...data]);
const wb = XLSX.utils.book_new();
XLSX.utils.book_append_sheet(wb, ws, '持仓');
const outPath = path.join(__dirname, '持仓数据导出.xlsx');
XLSX.writeFile(wb, outPath);
console.log('已生成:', outPath);
